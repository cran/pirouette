<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Partial function evaluation in pirouette</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Partial function evaluation in
pirouette</h1>



<p>This vignette describes partial function evaluation used in
<code>pirouette</code>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(pirouette)</span></code></pre></div>
<p>We’ll use <code>pryr</code> (from the Tidyverse to get that
functionality.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">library</span>(pryr)</span></code></pre></div>
<div id="the-functions" class="section level2">
<h2>The functions</h2>
<p>These are the functions we’ll create, in order of increasing
complexity:</p>
<ol style="list-style-type: decimal">
<li>Create a twin tree</li>
<li>Create a true alignment</li>
<li>Create a twin alignment</li>
</ol>
</div>
<div id="create-a-twin-tree" class="section level2">
<h2>1. create a twin tree</h2>
<p>We start from a simple true tree:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>true_phylogeny <span class="ot">&lt;-</span> ape<span class="sc">::</span><span class="fu">read.tree</span>(<span class="at">text =</span> <span class="st">&quot;((A:1, B:1):1, C:2);&quot;</span>)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>ape<span class="sc">::</span><span class="fu">plot.phylo</span>(true_phylogeny, <span class="at">main =</span> <span class="st">&quot;True phylogeny&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>To create a twin tree, I will describe:</p>
<ul>
<li>1.1 Create a twin tree using the defaults</li>
<li>1.2 Create a twin tree using a built-in BD model</li>
<li>1.3 Create a twin tree using a custom function</li>
<li>1.4 Create a twin tree using a custom function with more
arguments</li>
<li>1.5 Create a twin tree using a built-in function with more arguments
that uses the Yule speciation model</li>
<li>1.6 Create a twin tree using a built-in function to copy a tree</li>
</ul>
<div id="create-a-twin-tree-using-the-defaults" class="section level3">
<h3>1.1 Create a twin tree using the defaults</h3>
<p>To create a twin tree from the true tree using the default settings
is easily done by calling <code>create_twin_tree</code>:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>twin_tree <span class="ot">&lt;-</span> pirouette<span class="sc">::</span><span class="fu">create_twin_tree</span>(true_phylogeny)</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>ape<span class="sc">::</span><span class="fu">plot.phylo</span>(twin_tree, <span class="at">main =</span> <span class="st">&quot;Twin phylogeny&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The <code>create_twin_tree</code> function creates the twin tree in
the way specified in its other function argument: the
<code>twinning_params</code>:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>twinning_params <span class="ot">&lt;-</span> pirouette<span class="sc">::</span><span class="fu">create_twinning_params</span>()</span></code></pre></div>
<p>Calling <code>create_twin_tree</code> results in the same twin tree
(yes, go ahead and check!):</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>twin_tree <span class="ot">&lt;-</span> pirouette<span class="sc">::</span><span class="fu">create_twin_tree</span>(</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>  <span class="at">phylogeny =</span> true_phylogeny,</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>  <span class="at">twinning_params =</span> twinning_params</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>)</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>ape<span class="sc">::</span><span class="fu">plot.phylo</span>(twin_tree, <span class="at">main =</span> <span class="st">&quot;Twin phylogeny&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="create-a-twin-tree-using-a-built-in-bd-model" class="section level2">
<h2>1.2 Create a twin tree using a built-in BD model</h2>
<p>How to specify <em>how</em> the twin tree is created? Set the value
for the <code>twinning_params$sim_twin_tree_fun</code>!</p>
<p>I’ll demonstrate using the <code>get_sim_bd_twin_tree_fun</code>
which produces a function that simulates a twin tree using a Birth-Death
speciation model:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>twinning_params <span class="ot">&lt;-</span> pirouette<span class="sc">::</span><span class="fu">create_twinning_params</span>(</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>  <span class="at">sim_twin_tree_fun =</span> pirouette<span class="sc">::</span><span class="fu">get_sim_bd_twin_tree_fun</span>()</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>)</span></code></pre></div>
<p>Proceed as usual here to simulate the twin tree:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>twin_tree <span class="ot">&lt;-</span> pirouette<span class="sc">::</span><span class="fu">create_twin_tree</span>(</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>  <span class="at">phylogeny =</span> true_phylogeny,</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>  <span class="at">twinning_params =</span> twinning_params</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>)</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>ape<span class="sc">::</span><span class="fu">plot.phylo</span>(twin_tree, <span class="at">main =</span> <span class="st">&quot;Twin phylogeny&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAACoFBMVEUAAAABAQECAgIDAwMEBAQFBQUGBgYHBwcICAgJCQkKCgoLCwsMDAwNDQ0ODg4PDw8QEBARERESEhITExMUFBQVFRUWFhYXFxcYGBgZGRkaGhobGxscHBwdHR0eHh4fHx8gICAhISEiIiIjIyMkJCQlJSUmJiYnJycoKCgpKSkqKiorKyssLCwtLS0uLi4vLy8wMDAxMTEyMjIzMzM0NDQ2NjY3Nzc4ODg5OTk7Ozs8PDw+Pj4/Pz9AQEBBQUFDQ0NERERFRUVHR0dISEhJSUlLS0tMTExNTU1OTk5PT09QUFBRUVFSUlJUVFRVVVVWVlZXV1dYWFhZWVlaWlpbW1tcXFxdXV1fX19gYGBhYWFiYmJlZWVmZmZnZ2doaGhqampra2tsbGxtbW1vb29wcHBycnJ0dHR1dXV3d3d6enp7e3t9fX1+fn5/f3+AgICBgYGCgoKDg4OEhISFhYWGhoaHh4eIiIiKioqLi4uMjIyNjY2Ojo6Pj4+QkJCRkZGSkpKUlJSWlpaXl5eYmJiZmZmampqbm5ucnJydnZ2enp6goKChoaGioqKjo6OkpKSlpaWnp6eoqKipqamqqqqrq6usrKytra2urq6vr6+wsLCxsbGysrKzs7O0tLS1tbW2tra3t7e4uLi6urq7u7u8vLy9vb2+vr6/v7/AwMDBwcHCwsLDw8PExMTFxcXIyMjJycnKysrLy8vMzMzNzc3Ozs7Q0NDR0dHS0tLT09PU1NTV1dXW1tbX19fY2NjZ2dna2trb29vc3Nzd3d3e3t7f39/h4eHi4uLj4+Pl5eXm5ubn5+fp6enq6urr6+vu7u7v7+/w8PDx8fHy8vLz8/P09PT19fX29vb39/f4+Pj5+fn6+vr7+/v8/Pz9/f3+/v7///8nwWF2AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAIJElEQVR4nO3d/X+VdR3H8ffmhkIslLiZ22EjnTbvlsK4yaxI7jRMEdQCbyAiSk2BIEIyUEahgNwUwyhAsiAUFBXxlrLAMkgLLIRtcD7/St/vdbZxzh6cvXl8x7k2r96vH3YdrnM+3+08Odc5Fzy2HZjqNHT3F9DTExBJQCQBkQREEhBJQCQBkQREEhBJQCQBkQREEhBJQCQBkQREEhBJQCQBkQREEhBJQCQBkQREEhBJQCQBkQREEhBJQKSCAo1Bez/KvWYsLiKzZ78FnzvfCYhUUKAtDQ0NE4C73WZf7jXbGn5BZv8vgHyPAivNRqN3i50sRaXZG8B3M3e0HqmPpqYG3vrXttumUH9gQv9hjzRZRHFsWtXAqR/YZOD3bsd3gAOtQM3zv9Rv6MQ/RjPHZw+pWbgR2OMuv3dnTd8bnmix7KWzp0OKCehh4HV7xR1qR+wpYEsb0CVX+8Pv8ydab5tC9RC/Y0SzByod4S/Xt2wGZrsrr0Bd6yPo6Bejo7bIH7anRvqL10dAO/pG+ye0ZC+dPR1STEAvAMvtSfcVb7UHUPJxGxCuXLGoAtjcetsUMGDFmsuAZzwFhjzZMAB4peliXGF2KHoei+ZmA7ftXDsYJe+YLXUgm+6AB2qpRe3e92cCT2QvnT0dUkxATZ/Bt206qjHXfe03WhtQ0fvRXXys9bYO6HmzA0X4WgS017zpOpsGvGfLgT9n5tyRes1ps13AfWbVqGy29EgPtB3Y5B5Sl+L6nKWzpkOKCcjG4SqrwwJMbOqFR9uByt01e8/85aYwwG9uwJDoEEub/dZPPw88bpP8/Y7m3gLm+ZuV48v23yI84C4u80CPA3WjRo0qQ/Hp7KWzpkOKC2gJio6UXHwIFa9GTxdtT9Lumteyga71m/EobXu92uqnTw3CmJZ+WGiZvdsyK9pwVNmbcI9Js1/7Ree0n1P8O3vprOmQ4gJyr13z8HUbgIdR1pIfaKDfDEdNDpDNRK/ngL9YZq9Dme9vVoHRdhiY5S6u8EA/88dSa9lLn5kOKS6g9CBU4iG7GRWYaPmBsMO9WBfjllyg3e7gwTBrnTtRgrp09Lw/3awvLj8dnZHuMafwrLvJysdW5i59ZjqkuIBsinvo/8YedB+XWidAg59eXwPszAVKV7mxRdY2585p7ti9oRwX7Deb5S5vmZZ5FatB9a6D7jM8lLv0memQYgNypz84bM+6j+9afqCqCv8cco/lAtn33c6D1rb3X9dmzoP8U/XhlL+Yip7Ynusd7f/q8Q5Lt0+HFBvQ3+Bfm/4OVPg/5QOqf3vsJcMWp60D0D53wmjtc9Y0d/Rnq8fvjPYcmVJR/b11mTPptyZVlw1bdtI6LN0+HVKP+u+OVL47cgT4ydmv2b/fn98sBj7Iv2z+6XPo0wDU3DQnOu87W7Uo3vDxrsHuLCtfnU2fQ58GoLVFwNg8Iy/1j553yt/Ou2hn0+dQjwK6c8yMs+3e0Kvm7n/mmzm2ZNqE+5d/kn/RTqd5PQqoJyYgkoBIAiIJiCQgkoBIAiIJiCQgkoBIAiIJiCQgkoBIAiIJiCQgkoBIAiIJiCQgkoBIAiIJiCQgkoBIAiIlHmh1n5uWrJ9RPDt0PulAL5Yu9ptZxaHf4JFwoKODpkfbl27cH7hCwoGW9+rCtwZFFQRo4Vdu7wlN3m4jvtnV+1IQoJlTftUjOnQUP+7qfSkI0IMLCrFqQG9iVbRNz20MXSLZQAcxJ9puxIuhSyQb6FTqC8fc5tXyu4KXSDaQrUbd0lX3X3T7f4JXSDiQ/XJUv6pb13dhgaQDdTkBkQREEhBJQCQBkQREEhBJQCQBkQREEhBJQCQBkQREEhBJQCQBkQREEhBJQCQBkQREEhBJQCQBkQREEhBJQCQBkQREEhBJQCQBkQREEhBJQCQBkQRESjrQKv/bpktr1wUvkHSgmf0bGzeuGF70RugCSQcaMc5/3Ivgb7ZPOFDzhf6dbWzthf8IXSHhQK/hd2bHtqXCf64uHqAPD3ZLzf5ts3xzwu9LPECXpi7rjn5u06saGxvX3IbVwfclHqCRLxfi05xD1032H1sGTgpeIdlAxy/IvCXL0HuDl0g20G78wW92RO+rFVaygX6Kpzdv3jS/7/jwJZINNDX6h0bdvFPhSyQb6DwkIJKASAIiCYgkIJKASAIiCYgkIJKASAIiCYgkIJKASAIiCYgkIJKASAUBmtXxd7leuacQnyaWCgI096YOv5f3c9sL8WliKZ7fJ61DjCQgkoBIAiIJiCQgkoBIAiIJiCQgkoBIAiIJiCQgkoBIAiIJiCQgkoBI3Qq0CpVdmE4+0CepsqIT4ePJB1rQZykOhI8nHujDskf2YWv4fOKBZlQe/wjLwufjAbr8nh90R7vN/lSyxqxP8BsZxwX0w3mLuqPXzW6pT5vVTgz/0hP+Tr0vZH7q+ZrwFZINlK4ft8v1jd7p4CWSDbSu+B2/WYDDwUskGujk0G9F22cQ/u03iQY6HwmIJCCSgEgCIgmIJCCSgEgCIgmIJCCSgEgCIgmIJCCSgEgCIgmIJCCSgEgCIgmIJCCSgEgCIgmIJCCSgEgCIgmIJCCSgEgCIgmIJCCSgEgCIgmIJCCSgEgCIgmIJCCSgEgCIgmIJCCSgEgCIgmIJCCSgEgCIgmIJCCSgEgCIgmIJCCSgEgCIgmIJCCSgEgCIgmIJCCSgEgCIgmIJCCSgEgCIgmIJCCSgEgCIgmIJCCSgEgCIgmIJCCSgEgCIgmIJCCSgEgCIgmIJCCSgEgCIgmIJCCSgEgCIv0Po+k2gJKY1rUAAAAASUVORK5CYII=" /><!-- --></p>
<div id="create-a-twin-tree-using-a-custom-function" class="section level3">
<h3>1.3 Create a twin tree using a custom function</h3>
<p><code>twinning_params$sim_twin_tree_fun</code> must be a function
that takes <em>one</em> argument, which must be the true phylogeny.</p>
<p>Here is an example that creates a twin tree by simulation a random
coalescent tree with the same number of tips:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co"># Define my function</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>my_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(true_phylogeny) {</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>  new_phylo <span class="ot">&lt;-</span> ape<span class="sc">::</span><span class="fu">rcoal</span>(<span class="at">n =</span> ape<span class="sc">::</span><span class="fu">Ntip</span>(true_phylogeny))</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>  new_phylo<span class="sc">$</span>tip.label <span class="ot">&lt;-</span> true_phylogeny<span class="sc">$</span>tip.label <span class="co"># nolint ape style, not mine</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>  new_phylo</span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>}</span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a><span class="co"># Put my function in the twinning_params</span></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a>twinning_params <span class="ot">&lt;-</span> pirouette<span class="sc">::</span><span class="fu">create_twinning_params</span>(</span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a>  <span class="at">sim_twin_tree_fun =</span> my_fun</span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a>)</span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a><span class="co"># Create a twin tree using my function</span></span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a>twin_tree <span class="ot">&lt;-</span> pirouette<span class="sc">::</span><span class="fu">create_twin_tree</span>(</span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a>  <span class="at">phylogeny =</span> true_phylogeny,</span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a>  <span class="at">twinning_params =</span> twinning_params</span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a>)</span>
<span id="cb9-16"><a href="#cb9-16" tabindex="-1"></a><span class="co"># Show the twin tree created by my function</span></span>
<span id="cb9-17"><a href="#cb9-17" tabindex="-1"></a>ape<span class="sc">::</span><span class="fu">plot.phylo</span>(twin_tree, <span class="at">main =</span> <span class="st">&quot;Twin phylogeny&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAACnVBMVEUAAAABAQECAgIDAwMEBAQFBQUGBgYHBwcICAgJCQkKCgoLCwsMDAwNDQ0ODg4PDw8QEBARERESEhIUFBQVFRUWFhYXFxcYGBgZGRkaGhobGxscHBwdHR0eHh4fHx8gICAhISEiIiIjIyMkJCQlJSUmJiYnJycoKCgpKSkqKiorKyssLCwtLS0uLi4vLy8wMDAxMTEyMjIzMzM0NDQ2NjY3Nzc4ODg5OTk7Ozs8PDw+Pj4/Pz9AQEBBQUFDQ0NERERFRUVHR0dISEhJSUlLS0tMTExNTU1OTk5PT09QUFBRUVFSUlJUVFRVVVVWVlZXV1dYWFhZWVlaWlpbW1tcXFxdXV1fX19gYGBhYWFiYmJlZWVmZmZnZ2doaGhqampra2tsbGxtbW1ubm5vb29wcHBycnJ0dHR1dXV3d3d4eHh6enp7e3t9fX1/f3+AgICBgYGCgoKDg4OEhISFhYWGhoaHh4eIiIiKioqLi4uMjIyNjY2Ojo6Pj4+QkJCRkZGSkpKUlJSWlpaXl5eYmJiZmZmampqbm5ucnJydnZ2enp6goKChoaGioqKjo6OkpKSlpaWnp6eoqKipqamqqqqrq6usrKytra2urq6vr6+wsLCxsbGysrKzs7O0tLS1tbW2tra3t7e4uLi6urq7u7u8vLy9vb2+vr6/v7/AwMDBwcHCwsLDw8PExMTFxcXJycnKysrLy8vMzMzNzc3Ozs7Q0NDR0dHS0tLT09PU1NTV1dXW1tbX19fY2NjZ2dna2trb29vc3Nzd3d3e3t7f39/h4eHi4uLj4+Pl5eXm5ubn5+fp6enq6urr6+vu7u7v7+/w8PDx8fHy8vLz8/P09PT19fX29vb39/f4+Pj5+fn6+vr7+/v8/Pz9/f3+/v7////MiMAaAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAIKUlEQVR4nO3d/3+VZR3H8ffmhkJM5OvaDhvZrJU6FYYjs8T4pmGIoCWUgiRR+Q0IJEQDZRQJyJdiGAVIFoSCqIjfojCwFMwCC2EbnM/f0nXdZxvn8ODsPa9xTju379cP5z7c576u+5wn5z7nhsd2Dkx1Gv7fd6CnJyCSgEgCIgmIJCCSgEgCIgmIJCCSgEgCIgmIJCCSgEgCIgmIJCCSgEgCIgmIJCCSgEgCIgmIJCCSgEgCIgmIJCCSgEg5BRqNjn6SecsYXELGnn8LPu5CJyBSToG2NDY2jgfucot9mbdsa/wFGfupAPI9Aqw0G4XerXaqFJVmrwP3px5oPRIfTk0MuvVv7dsmUH9g/IDhDzdbRHF8WtWgqe/ZZOAPbsV9wIE2oJb5X+k3bMKfojEnZg+tWbgR2OOuH7yjpu91T7Za+tTpo0PKE9BDwGv2sjvUjtovgS3tQP2/7A+/z51s2zaB6qF+xcgWD1Q60l+vb90MzHY3XoG6tmfQsWuio7bIH7anr/dXr42AdvSN1o9vTZ86fXRIeQJ6AVhuT7l7vNXuRclH7UD4wopFFcDmtm0TwMAVay4HnvEUGPpU40Dg5ebLcIXZ4eh1LBo3G7ht59ohKHnbbKkD2XQ7PFBrLWr3vjsTeDJ96vTRIeUJqPkzuNumoxpz3X2/wdqBit6NHuJjbds6oOfNDhThpghor3nTdTYNOGjLgb+mxrkj9cozZruA75lVo7LFktd7oO3AJveU+iyuzZg6bXRIeQKysfiS1WEBJjT3wiMdQOXulr1n/3ITGOgX12FodIglzX7nRz8PPGET/eOOxr0JzPObleOr9t8i3OuuLvNATwB1DQ0NZSg+kz512uiQ8gW0BEVHSy47jIpXopeL9hdpd8ur6UBX+cU4lLa/X231o08PxujWflhoqbXbUjPaCFTZG3DPSbPf+EnndJxT/Dt96rTRIeULyL13zcPNNhAPoaw1O9AgvxiBmgwgm4lezwHvWGqtQ5nvN6vAKDsCzHJXV3ign/ljqa30qc+ODilfQMnBqMSD9g1UYIJlB8IO92ZdjFsygXa7gwfDrW3cyRLUJaPX/elmffH5M9EZ6R5zCs+6TVY+tjJz6rOjQ8oXkE1xT/3f2gPucql1AjTk6fU1wM5MoGSVG7bI2se5c5rbd28ox0X7zWa561umpd7FalC965Dbw4OZU58dHVLegNzpD47Ys+7yz5YdqKrCv4Z82zKB7Idu5SFrX/uvq1LnQf6l+kjCX01EL2zP9Y7Wf/3EOVN3jA4pb0B/h39v+gdQ4f+UDaj+rTH9hy9O2jlA+9wJo3WMs+a5oy6tHrczWnN0SkX1D9alzqTfnFhdNnzZKTtn6o7RIfWo/+5IZHsgR4Gfnv+W/fv9+c1i4L3s02Yf3YUKAaileU503ne+alG84aNdQ9xZVrY6G92FCgFobREwJsuQlwZErzvlb2WdtLPRXahHAd0xesb5Vm/oVXPXB9nGHF8ybfw9yz/OPmmno3k9CqgnJiCSgEgCIgmIJCCSgEgCIgmIJCCSgEgCIgmIJCCSgEgCIgmIJCCSgEgCIgmIJCCSgEgCIgmIJCCSgEgCIsUeaHWfG5esn1E8O3R83IFeLF3sF7OKQ3/AI+ZAxwZPj5Yv3bA/cIaYAy3v1Y0fDYrKCdDCr03qCU3ebiO/1d3HkhOgmVN+3SM6fAyPdvex5ATogQW5mDWgN7AqWibnNoVOEW+gQ5gTLTfixdAp4g10OvHF427xSvmdwVPEG8hWo27pqnsumfSf4BliDmS/auhXdev6bkwQd6BuJyCSgEgCIgmIJCCSgEgCIgmIJCCSgEgCIgmIJCCSgEgCIgmIJCCSgEgCIgmIJCCSgEgCIgmIJCCSgEgCIgmIJCCSgEgCIgmIJCCSgEgCIgmIJCCSgEhxB1rlP226tHZd8ARxB5o5oKlp44oRRa+HThB3oJFj/eVeBP+wfcyBWi7232xjay9+P3SGmAO9it+bHd+WCP+9ukIEaj54qGu1+K/N8s0J31khAt3d//Ku9XObXtXU1LTmNqwO3lkhAj364y5vevVkf9k6aGLwzuINdOKi1FeyDPtu8M7iDbQbf/SLHdH3aoUVb6DH8fTmzZvm9x0XvrN4A02N/qFRN+90+M7iDXQBEhBJQCQBkQREEhBJQCQBkQREEhBJQCQBkQREEhBJQCQBkQREEhBJQKScAM3K7We53nlfLu50lnICNPfGnH7K79WTcnGns1SInydd+IdYjhMQSUAkAZEERBIQSUAkAZEERBIQSUAkAZEERBIQSUAkAZEERBIQSUCkTwi0CpXd2Fn8gT5OlBWdDN9Z/IEW9FmKA+E7iz3QP8se3oet4TuLPdCMyhMfYln4zgoR6PsNP+pau83+UrLGrE/wFxkXJtD2+xd1rdfMbqlPmtVOCN9ZIQJ9gl5I/dbzleEzxBsoWT92l+ubvZPBU8QbaF3x236xAEeCp4g10Klh34mWz2BP8ByxBroQCYgkIJKASAIiCYgkIJKASAIiCYgkIJKASAIiCYgkIJKASAIiCYgkIJKASAIiCYgkIJKASAIiCYgkIJKASAIiCYgkIJKASAIiCYgkIJKASAIiCYgkIJKASAIiCYgkIJKASAIiCYgkIJKASAIiCYgkIJKASAIiCYgkIJKASAIiCYgkIJKASAIiCYgkIJKASAIiCYgkIJKASAIiCYgkIJKASAIiCYgkIJKASAIiCYgkIJKASAIiCYgkIJKASAIiCYgkIJKASAIiCYgkIJKASAIiCYgkIJKASAIi/Q8h3TrGxtXi5QAAAABJRU5ErkJggg==" /><!-- --></p>
</div>
<div id="create-a-twin-tree-using-a-built-in-function-with-more-arguments" class="section level3">
<h3>1.4 Create a twin tree using a built-in function with more
arguments</h3>
<p>So, <code>twinning_params$sim_twin_tree_fun</code> must be a function
that takes <em>one</em> argument, which is the true phylogeny. What if
we want a function that indeed has one argument for the true phylogeny,
but also some additional ones?</p>
<p>An example is <code>sim_bd_twin_tree</code>, which uses a method and
a number of replicates:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">head</span>(sim_bd_twin_tree)</span></code></pre></div>
<pre><code>##                                                                           
## 1 function (true_phylogeny, method = &quot;random_tree&quot;, n_replicates = 10000, 
## 2     os = rappdirs::app_dir()$os)                                        
## 3 {                                                                       
## 4     beastier::check_os(os)                                              
## 5     methods &lt;- c(&quot;random_tree&quot;, &quot;max_clade_cred&quot;, &quot;max_likelihood&quot;)     
## 6     if (!method %in% methods) {</code></pre>
<p>We cannot simply plug it in:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">tryCatch</span>(</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>  pirouette<span class="sc">::</span><span class="fu">create_twinning_params</span>(</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>    <span class="at">sim_twin_tree_fun =</span> sim_bd_twin_tree</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>  ),</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>  <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>    <span class="fu">cat</span>(e<span class="sc">$</span>message)</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>  }</span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## Warning in if (stringr::str_count(string = arguments, pattern = &quot;,&quot;) &gt; 0) {:
## the condition has length &gt; 1 and only the first element will be used</code></pre>
<pre><code>## &#39;sim_twin_tree_fun&#39; must be a function with one argument</code></pre>
<p>Instead, we’ll need partial function evaluation, which will create a
function with one a ellipsis (<code>...</code>) argument that will fill
in the values you specified:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="co"># Create my partially evaluated function</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>sim_twin_tree_fun <span class="ot">&lt;-</span> pryr<span class="sc">::</span><span class="fu">partial</span>(</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>  sim_bd_twin_tree,</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">&quot;random_tree&quot;</span>,</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>  <span class="at">n_replicates =</span> <span class="dv">1</span></span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>)</span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a><span class="co"># Create twinning_params with my function</span></span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a>twinning_params <span class="ot">&lt;-</span> pirouette<span class="sc">::</span><span class="fu">create_twinning_params</span>(</span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a>  <span class="at">sim_twin_tree_fun =</span> sim_twin_tree_fun</span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a>)</span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a><span class="co"># Create a twin tree using my function</span></span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a>twin_tree <span class="ot">&lt;-</span> pirouette<span class="sc">::</span><span class="fu">create_twin_tree</span>(</span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a>  <span class="at">phylogeny =</span> true_phylogeny,</span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a>  <span class="at">twinning_params =</span> twinning_params</span>
<span id="cb15-15"><a href="#cb15-15" tabindex="-1"></a>)</span>
<span id="cb15-16"><a href="#cb15-16" tabindex="-1"></a><span class="co"># Show the twin tree</span></span>
<span id="cb15-17"><a href="#cb15-17" tabindex="-1"></a>ape<span class="sc">::</span><span class="fu">plot.phylo</span>(twin_tree, <span class="at">main =</span> <span class="st">&quot;Twin phylogeny&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>There is a helper function called
<code>get_sim_bd_twin_tree_fun</code> that does the same partial
function evaluation for you:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="co"># Create twinning_params with my function</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>twinning_params <span class="ot">&lt;-</span> pirouette<span class="sc">::</span><span class="fu">create_twinning_params</span>(</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>  <span class="at">sim_twin_tree_fun =</span> pirouette<span class="sc">::</span><span class="fu">get_sim_bd_twin_tree_fun</span>(</span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">&quot;random_tree&quot;</span>,</span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>    <span class="at">n_replicates =</span> <span class="dv">1</span></span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a>  )</span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a>)</span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a><span class="co"># Create a twin tree using my function</span></span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a>twin_tree <span class="ot">&lt;-</span> pirouette<span class="sc">::</span><span class="fu">create_twin_tree</span>(</span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a>  <span class="at">phylogeny =</span> true_phylogeny,</span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a>  <span class="at">twinning_params =</span> twinning_params</span>
<span id="cb16-12"><a href="#cb16-12" tabindex="-1"></a>)</span>
<span id="cb16-13"><a href="#cb16-13" tabindex="-1"></a><span class="co"># Show the twin tree</span></span>
<span id="cb16-14"><a href="#cb16-14" tabindex="-1"></a>ape<span class="sc">::</span><span class="fu">plot.phylo</span>(twin_tree, <span class="at">main =</span> <span class="st">&quot;Twin phylogeny&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="create-a-twin-tree-using-a-built-in-function-with-more-arguments-that-uses-the-yule-speciation-model" class="section level3">
<h3>1.5 Create a twin tree using a built-in function with more arguments
that uses the Yule speciation model</h3>
<p>Now using a Yule model:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="co"># Create twinning_params with my function</span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>twinning_params <span class="ot">&lt;-</span> pirouette<span class="sc">::</span><span class="fu">create_twinning_params</span>(</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>  <span class="at">sim_twin_tree_fun =</span> pirouette<span class="sc">::</span><span class="fu">create_sim_yule_twin_tree_fun</span>(</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">&quot;random_tree&quot;</span>,</span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>    <span class="at">n_replicates =</span> <span class="dv">1</span></span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a>  )</span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a>)</span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a><span class="co"># Create a twin tree using my function</span></span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a>twin_tree <span class="ot">&lt;-</span> <span class="fu">create_twin_tree</span>(</span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a>  <span class="at">phylogeny =</span> true_phylogeny,</span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a>  <span class="at">twinning_params =</span> twinning_params</span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a>)</span>
<span id="cb17-13"><a href="#cb17-13" tabindex="-1"></a><span class="co"># Show the twin tree</span></span>
<span id="cb17-14"><a href="#cb17-14" tabindex="-1"></a>ape<span class="sc">::</span><span class="fu">plot.phylo</span>(twin_tree, <span class="at">main =</span> <span class="st">&quot;Twin phylogeny&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="create-a-twin-tree-using-a-built-in-function-to-copy-a-tree" class="section level3">
<h3>1.6 Create a twin tree using a built-in function to copy a tree</h3>
<p>Now using a copy function:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="co"># Create twinning_params</span></span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>twinning_params <span class="ot">&lt;-</span> pirouette<span class="sc">::</span><span class="fu">create_twinning_params</span>(</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>  <span class="at">sim_twin_tree_fun =</span> pirouette<span class="sc">::</span><span class="fu">create_copy_twtr_from_true_fun</span>()</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>)</span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a><span class="co"># Create a twin tree using my function</span></span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a>twin_tree <span class="ot">&lt;-</span> <span class="fu">create_twin_tree</span>(</span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a>  <span class="at">phylogeny =</span> true_phylogeny,</span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a>  <span class="at">twinning_params =</span> twinning_params</span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a>)</span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a><span class="co"># Show the twin tree</span></span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a>ape<span class="sc">::</span><span class="fu">plot.phylo</span>(twin_tree, <span class="at">main =</span> <span class="st">&quot;Twin phylogeny&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Using partial function evaluation you can now plug in any function to
create a twin tree!</p>
</div>
</div>
<div id="create-a-true-alignment" class="section level2">
<h2>2. create a true alignment</h2>
<p>We start from a simple true tree:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>true_phylogeny <span class="ot">&lt;-</span> ape<span class="sc">::</span><span class="fu">read.tree</span>(<span class="at">text =</span> <span class="st">&quot;((A:1, B:1):1, C:2);&quot;</span>)</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>ape<span class="sc">::</span><span class="fu">plot.phylo</span>(true_phylogeny, <span class="at">main =</span> <span class="st">&quot;True phylogeny&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Also, we’ll specify a root sequence:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>root_sequence <span class="ot">&lt;-</span> pirouette<span class="sc">::</span><span class="fu">create_blocked_dna</span>(<span class="at">length =</span> <span class="dv">16</span>)</span></code></pre></div>
<p>We want to create a true alignment from it. There is a function that
does so:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>alignment_params <span class="ot">&lt;-</span> pirouette<span class="sc">::</span><span class="fu">create_alignment_params</span>(</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>  <span class="at">root_sequence =</span> root_sequence</span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>)</span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a>true_alignment <span class="ot">&lt;-</span> pirouette<span class="sc">::</span><span class="fu">sim_true_alignment</span>(</span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a>  <span class="at">true_phylogeny =</span> true_phylogeny,</span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a>  <span class="at">alignment_params =</span> alignment_params</span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a>)</span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a>ape<span class="sc">::</span><span class="fu">image.DNAbin</span>(true_alignment, <span class="at">main =</span> <span class="st">&quot;True alignment&quot;</span>, <span class="at">legend =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>How to specify <em>how</em> the true alignment is created? Use the
<code>alignment_params$sim_tral_fun</code>:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a>alignment_params <span class="ot">&lt;-</span> pirouette<span class="sc">::</span><span class="fu">create_alignment_params</span>(</span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>  <span class="at">sim_tral_fun =</span> sim_tral_with_std_nsm,</span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>  <span class="at">root_sequence =</span> root_sequence</span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a>)</span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a>true_alignment <span class="ot">&lt;-</span> pirouette<span class="sc">::</span><span class="fu">sim_true_alignment</span>(</span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a>  <span class="at">true_phylogeny =</span> true_phylogeny,</span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a>  <span class="at">alignment_params =</span> alignment_params</span>
<span id="cb22-8"><a href="#cb22-8" tabindex="-1"></a>)</span>
<span id="cb22-9"><a href="#cb22-9" tabindex="-1"></a>ape<span class="sc">::</span><span class="fu">image.DNAbin</span>(true_alignment, <span class="at">main =</span> <span class="st">&quot;True alignment&quot;</span>, <span class="at">legend =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Due to this architecture, <code>alignment_params$sim_tral_fun</code>
must be a function that takes <em>one</em> argument, which is the true
phylogeny.</p>
<p>Here is an example that creates a true alignment by simulating a
random alignment with the same number of taxa:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="co"># My function</span></span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>my_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(</span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a>  true_phylogeny,</span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a>  root_sequence</span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a>) {</span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a>  sequences <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_len</span>(ape<span class="sc">::</span><span class="fu">Ntip</span>(true_phylogeny))) {</span>
<span id="cb23-8"><a href="#cb23-8" tabindex="-1"></a>    sequences[[i]] <span class="ot">&lt;-</span> <span class="fu">rep</span>(</span>
<span id="cb23-9"><a href="#cb23-9" tabindex="-1"></a>      <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;c&quot;</span>, <span class="st">&quot;g&quot;</span>, <span class="st">&quot;t&quot;</span>), <span class="at">size =</span> <span class="dv">1</span>),</span>
<span id="cb23-10"><a href="#cb23-10" tabindex="-1"></a>      <span class="fu">nchar</span>(root_sequence)</span>
<span id="cb23-11"><a href="#cb23-11" tabindex="-1"></a>    )</span>
<span id="cb23-12"><a href="#cb23-12" tabindex="-1"></a>  }</span>
<span id="cb23-13"><a href="#cb23-13" tabindex="-1"></a>  ape<span class="sc">::</span><span class="fu">as.DNAbin</span>(sequences)</span>
<span id="cb23-14"><a href="#cb23-14" tabindex="-1"></a>}</span>
<span id="cb23-15"><a href="#cb23-15" tabindex="-1"></a><span class="co"># Putting my function in the alignment_params</span></span>
<span id="cb23-16"><a href="#cb23-16" tabindex="-1"></a>alignment_params <span class="ot">&lt;-</span> pirouette<span class="sc">::</span><span class="fu">create_alignment_params</span>(</span>
<span id="cb23-17"><a href="#cb23-17" tabindex="-1"></a>  <span class="at">sim_tral_fun =</span> my_fun,</span>
<span id="cb23-18"><a href="#cb23-18" tabindex="-1"></a>  <span class="at">root_sequence =</span> root_sequence</span>
<span id="cb23-19"><a href="#cb23-19" tabindex="-1"></a>)</span>
<span id="cb23-20"><a href="#cb23-20" tabindex="-1"></a><span class="co"># Simulate the true alignment using my function</span></span>
<span id="cb23-21"><a href="#cb23-21" tabindex="-1"></a>true_alignment <span class="ot">&lt;-</span> pirouette<span class="sc">::</span><span class="fu">sim_true_alignment</span>(</span>
<span id="cb23-22"><a href="#cb23-22" tabindex="-1"></a>  <span class="at">true_phylogeny =</span> true_phylogeny,</span>
<span id="cb23-23"><a href="#cb23-23" tabindex="-1"></a>  <span class="at">alignment_params =</span> alignment_params</span>
<span id="cb23-24"><a href="#cb23-24" tabindex="-1"></a>)</span>
<span id="cb23-25"><a href="#cb23-25" tabindex="-1"></a><span class="co"># Show the true alignment</span></span>
<span id="cb23-26"><a href="#cb23-26" tabindex="-1"></a>ape<span class="sc">::</span><span class="fu">image.DNAbin</span>(true_alignment, <span class="at">main =</span> <span class="st">&quot;True alignment&quot;</span>, <span class="at">legend =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>So, <code>alignment_params$sim_tral_fun</code> must be a function
that takes <em>one</em> argument, which is the true phylogeny. What if
we want a function that indeed has one argument for the true phylogeny,
but also some additional ones?</p>
<p>An example is <code>sim_tral_with_std_nsm</code>, which uses a root
sequence of <code>acgt</code>, a mutation rate of 0.1 and a JC69 site
model:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="fu">head</span>(sim_tral_with_std_nsm)</span></code></pre></div>
<pre><code>##                                                                                                                
## 1 function (true_phylogeny, root_sequence, mutation_rate = 1, site_model = beautier::create_jc69_site_model()) 
## 2 {                                                                                                            
## 3     alignment &lt;- pirouette::sim_alignment_with_std_nsm(phylogeny = true_phylogeny,                           
## 4         root_sequence = root_sequence, mutation_rate = mutation_rate,                                        
## 5         site_model = site_model)                                                                             
## 6     pirouette::check_alignment(alignment)</code></pre>
<p>To change the default arguments, we’ll need partial function
evaluation, which will create a function with one a ellipsis
(<code>...</code>) argument that will fill in the values you
specified:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a>sim_tral_fun <span class="ot">&lt;-</span> pryr<span class="sc">::</span><span class="fu">partial</span>(</span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a>  sim_tral_with_std_nsm,</span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a>  <span class="at">mutation_rate =</span> <span class="fl">0.5</span>,</span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a>  <span class="at">site_model =</span> beautier<span class="sc">::</span><span class="fu">create_hky_site_model</span>()</span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a>)</span>
<span id="cb26-6"><a href="#cb26-6" tabindex="-1"></a><span class="fu">head</span>(sim_tral_fun)</span></code></pre></div>
<pre><code>##                                                                                              
## 1 function (...)                                                                             
## 2 sim_tral_with_std_nsm(mutation_rate = 0.5, site_model = beautier::create_hky_site_model(), 
## 3     ...)</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a>alignment_params <span class="ot">&lt;-</span> pirouette<span class="sc">::</span><span class="fu">create_alignment_params</span>(</span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a>  <span class="at">sim_tral_fun =</span> sim_tral_fun,</span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a>  <span class="at">root_sequence =</span> root_sequence</span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a>)</span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a>true_alignment <span class="ot">&lt;-</span> pirouette<span class="sc">::</span><span class="fu">sim_true_alignment</span>(</span>
<span id="cb28-6"><a href="#cb28-6" tabindex="-1"></a>  <span class="at">true_phylogeny =</span> true_phylogeny,</span>
<span id="cb28-7"><a href="#cb28-7" tabindex="-1"></a>  <span class="at">alignment_params =</span> alignment_params</span>
<span id="cb28-8"><a href="#cb28-8" tabindex="-1"></a>)</span>
<span id="cb28-9"><a href="#cb28-9" tabindex="-1"></a>ape<span class="sc">::</span><span class="fu">image.DNAbin</span>(true_alignment, <span class="at">main =</span> <span class="st">&quot;True alignment&quot;</span>, <span class="at">legend =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Instead of doing the partial function evaluation yourself,
<code>pirouette</code> supplies this function as
<code>get_sim_tral_with_std_nsm_fun</code>:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a>alignment_params <span class="ot">&lt;-</span> pirouette<span class="sc">::</span><span class="fu">create_alignment_params</span>(</span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a>  <span class="at">sim_tral_fun =</span></span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a>    pirouette<span class="sc">::</span><span class="fu">get_sim_tral_with_std_nsm_fun</span>(</span>
<span id="cb29-4"><a href="#cb29-4" tabindex="-1"></a>    <span class="at">mutation_rate =</span> <span class="fl">0.5</span>,</span>
<span id="cb29-5"><a href="#cb29-5" tabindex="-1"></a>    <span class="at">site_model =</span> beautier<span class="sc">::</span><span class="fu">create_hky_site_model</span>()</span>
<span id="cb29-6"><a href="#cb29-6" tabindex="-1"></a>  ),</span>
<span id="cb29-7"><a href="#cb29-7" tabindex="-1"></a>  <span class="at">root_sequence =</span> root_sequence</span>
<span id="cb29-8"><a href="#cb29-8" tabindex="-1"></a>)</span>
<span id="cb29-9"><a href="#cb29-9" tabindex="-1"></a>true_alignment <span class="ot">&lt;-</span> pirouette<span class="sc">::</span><span class="fu">sim_true_alignment</span>(</span>
<span id="cb29-10"><a href="#cb29-10" tabindex="-1"></a>  <span class="at">true_phylogeny =</span> true_phylogeny,</span>
<span id="cb29-11"><a href="#cb29-11" tabindex="-1"></a>  <span class="at">alignment_params =</span> alignment_params</span>
<span id="cb29-12"><a href="#cb29-12" tabindex="-1"></a>)</span>
<span id="cb29-13"><a href="#cb29-13" tabindex="-1"></a>ape<span class="sc">::</span><span class="fu">image.DNAbin</span>(true_alignment, <span class="at">main =</span> <span class="st">&quot;True alignment&quot;</span>, <span class="at">legend =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Or to use the linked node substitution model, use
<code>get_sim_tral_with_lns_nsm_fun</code>:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a><span class="cf">if</span> (<span class="dv">1</span> <span class="sc">==</span> <span class="dv">2</span>) { <span class="co"># nodeSub is not yet on CRAN</span></span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a>  alignment_params <span class="ot">&lt;-</span> pirouette<span class="sc">::</span><span class="fu">create_alignment_params</span>(</span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a>    <span class="at">sim_tral_fun =</span></span>
<span id="cb30-4"><a href="#cb30-4" tabindex="-1"></a>      <span class="fu">get_sim_tral_with_lns_nsm_fun</span>(</span>
<span id="cb30-5"><a href="#cb30-5" tabindex="-1"></a>      <span class="at">branch_mutation_rate =</span> <span class="fl">0.1</span>,</span>
<span id="cb30-6"><a href="#cb30-6" tabindex="-1"></a>      <span class="at">node_mutation_rate =</span> <span class="fl">0.2</span></span>
<span id="cb30-7"><a href="#cb30-7" tabindex="-1"></a>    ),</span>
<span id="cb30-8"><a href="#cb30-8" tabindex="-1"></a>    <span class="at">root_sequence =</span> root_sequence</span>
<span id="cb30-9"><a href="#cb30-9" tabindex="-1"></a>  )</span>
<span id="cb30-10"><a href="#cb30-10" tabindex="-1"></a>  true_alignment <span class="ot">&lt;-</span> pirouette<span class="sc">::</span><span class="fu">sim_true_alignment</span>(</span>
<span id="cb30-11"><a href="#cb30-11" tabindex="-1"></a>    <span class="at">true_phylogeny =</span> true_phylogeny,</span>
<span id="cb30-12"><a href="#cb30-12" tabindex="-1"></a>    <span class="at">alignment_params =</span> alignment_params</span>
<span id="cb30-13"><a href="#cb30-13" tabindex="-1"></a>  )</span>
<span id="cb30-14"><a href="#cb30-14" tabindex="-1"></a>  ape<span class="sc">::</span><span class="fu">image.DNAbin</span>(true_alignment, <span class="at">main =</span> <span class="st">&quot;True alignment&quot;</span>, <span class="at">legend =</span> <span class="cn">FALSE</span>)</span>
<span id="cb30-15"><a href="#cb30-15" tabindex="-1"></a>}</span></code></pre></div>
<p>Or to use the unlinked node substitution model, use
<code>get_sim_tral_with_uns_nsm_fun</code>:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a><span class="cf">if</span> (<span class="dv">1</span> <span class="sc">==</span> <span class="dv">2</span>) { <span class="co"># nodeSub is not yet on CRAN</span></span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a>  alignment_params <span class="ot">&lt;-</span> pirouette<span class="sc">::</span><span class="fu">create_alignment_params</span>(</span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a>    <span class="at">sim_tral_fun =</span></span>
<span id="cb31-4"><a href="#cb31-4" tabindex="-1"></a>      pirouette<span class="sc">::</span><span class="fu">get_sim_tral_with_uns_nsm_fun</span>(</span>
<span id="cb31-5"><a href="#cb31-5" tabindex="-1"></a>        <span class="at">branch_mutation_rate =</span> <span class="fl">1.0</span>,</span>
<span id="cb31-6"><a href="#cb31-6" tabindex="-1"></a>        <span class="at">node_mutation_rate =</span> <span class="fl">2.0</span>,</span>
<span id="cb31-7"><a href="#cb31-7" tabindex="-1"></a>        <span class="at">node_time =</span> <span class="fl">0.1</span></span>
<span id="cb31-8"><a href="#cb31-8" tabindex="-1"></a>      ),</span>
<span id="cb31-9"><a href="#cb31-9" tabindex="-1"></a>    <span class="at">root_sequence =</span> root_sequence</span>
<span id="cb31-10"><a href="#cb31-10" tabindex="-1"></a>  )</span>
<span id="cb31-11"><a href="#cb31-11" tabindex="-1"></a>  true_alignment <span class="ot">&lt;-</span> pirouette<span class="sc">::</span><span class="fu">sim_true_alignment</span>(</span>
<span id="cb31-12"><a href="#cb31-12" tabindex="-1"></a>    <span class="at">true_phylogeny =</span> true_phylogeny,</span>
<span id="cb31-13"><a href="#cb31-13" tabindex="-1"></a>    <span class="at">alignment_params =</span> alignment_params</span>
<span id="cb31-14"><a href="#cb31-14" tabindex="-1"></a>  )</span>
<span id="cb31-15"><a href="#cb31-15" tabindex="-1"></a>  ape<span class="sc">::</span><span class="fu">image.DNAbin</span>(true_alignment, <span class="at">main =</span> <span class="st">&quot;True alignment&quot;</span>, <span class="at">legend =</span> <span class="cn">FALSE</span>)</span>
<span id="cb31-16"><a href="#cb31-16" tabindex="-1"></a>}</span></code></pre></div>
<p>Using partial function evaluation you can now plug in any function to
create a true alignment.</p>
</div>
<div id="create-a-twin-alignment" class="section level2">
<h2>3. create a twin alignment</h2>
<p>To create a twin alignment, we need * a twin tree * a true alignent *
a root sequence</p>
<p>Note that some of these three elements may be ignored, but is some
cases you will need all three.</p>
<p>As the twin tree, we’ll use this:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a>twin_phylogeny <span class="ot">&lt;-</span> ape<span class="sc">::</span><span class="fu">read.tree</span>(<span class="at">text =</span> <span class="st">&quot;((A:2, B:2):1, C:3);&quot;</span>)</span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a>ape<span class="sc">::</span><span class="fu">plot.phylo</span>(twin_phylogeny, <span class="at">main =</span> <span class="st">&quot;Twin phylogeny&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The root sequence is short and simple:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a>root_sequence <span class="ot">&lt;-</span> pirouette<span class="sc">::</span><span class="fu">create_blocked_dna</span>(<span class="at">length =</span> <span class="dv">20</span>)</span></code></pre></div>
<p>As a true alignment, we’ll use something equally simple:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a>true_alignment <span class="ot">&lt;-</span> pirouette<span class="sc">::</span><span class="fu">get_test_alignment</span>(</span>
<span id="cb34-2"><a href="#cb34-2" tabindex="-1"></a>  <span class="at">n_taxa =</span> ape<span class="sc">::</span><span class="fu">Ntip</span>(true_phylogeny),</span>
<span id="cb34-3"><a href="#cb34-3" tabindex="-1"></a>  <span class="at">sequence_length =</span> <span class="fu">nchar</span>(root_sequence)</span>
<span id="cb34-4"><a href="#cb34-4" tabindex="-1"></a>)</span>
<span id="cb34-5"><a href="#cb34-5" tabindex="-1"></a>ape<span class="sc">::</span><span class="fu">image.DNAbin</span>(true_alignment, <span class="at">main =</span> <span class="st">&quot;True alignment&quot;</span>, <span class="at">legend =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>I will show multiple ways to create a twin alignment here:</p>
<ul>
<li>3.1. Copy the true alignment</li>
<li>3.2. Simulate an alignment based on the twin tree</li>
<li>3.3. Simulate an alignment based on the twin tree, true alignment
and root sequence</li>
</ul>
</div>
<div id="copy-the-true-alignment" class="section level2">
<h2>3.1. Copy the true alignment</h2>
<p>The function we’ll use has three parameters and ignores two:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a>my_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(</span>
<span id="cb35-2"><a href="#cb35-2" tabindex="-1"></a>  <span class="at">twin_phylogeny =</span> <span class="st">&quot;irrelevant&quot;</span>,</span>
<span id="cb35-3"><a href="#cb35-3" tabindex="-1"></a>  true_alignment,</span>
<span id="cb35-4"><a href="#cb35-4" tabindex="-1"></a>  <span class="at">root_sequence =</span> <span class="st">&quot;irrelevant&quot;</span></span>
<span id="cb35-5"><a href="#cb35-5" tabindex="-1"></a>) {</span>
<span id="cb35-6"><a href="#cb35-6" tabindex="-1"></a>  true_alignment</span>
<span id="cb35-7"><a href="#cb35-7" tabindex="-1"></a>}</span></code></pre></div>
<p>Put this function in the <code>twinning_params</code>:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a>twinning_params <span class="ot">&lt;-</span> pirouette<span class="sc">::</span><span class="fu">create_twinning_params</span>(</span>
<span id="cb36-2"><a href="#cb36-2" tabindex="-1"></a>  <span class="at">sim_twal_fun =</span> my_fun</span>
<span id="cb36-3"><a href="#cb36-3" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a>twin_alignment <span class="ot">&lt;-</span> pirouette<span class="sc">::</span><span class="fu">sim_twin_alignment</span>(</span>
<span id="cb37-2"><a href="#cb37-2" tabindex="-1"></a>  <span class="at">twin_phylogeny =</span> twin_phylogeny,</span>
<span id="cb37-3"><a href="#cb37-3" tabindex="-1"></a>  <span class="at">true_alignment =</span> true_alignment,</span>
<span id="cb37-4"><a href="#cb37-4" tabindex="-1"></a>  <span class="at">alignment_params =</span> pirouette<span class="sc">::</span><span class="fu">create_test_alignment_params</span>(</span>
<span id="cb37-5"><a href="#cb37-5" tabindex="-1"></a>    <span class="at">root_sequence =</span> root_sequence</span>
<span id="cb37-6"><a href="#cb37-6" tabindex="-1"></a>  ),</span>
<span id="cb37-7"><a href="#cb37-7" tabindex="-1"></a>  <span class="at">twinning_params =</span> twinning_params</span>
<span id="cb37-8"><a href="#cb37-8" tabindex="-1"></a>)</span>
<span id="cb37-9"><a href="#cb37-9" tabindex="-1"></a>ape<span class="sc">::</span><span class="fu">image.DNAbin</span>(twin_alignment, <span class="at">main =</span> <span class="st">&quot;Twin alignment&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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3vuEgGleXV3d9evXp06dKpVKp0yZ8ve//511RX9//6KioqKiIltbW/XxhoYGIho/frxqZPz48deuXdPstdqfVp3YLwobG5urV6/yK0/emTNnJBKJtbW1dua9T/gMpmFKpfLatWs//fTThg0bxowZk5ub+9577z148CA6Olr7zTQ2NhKR+mnFlpaWHMe1tLQMGzaMdXUtLApjY2P1NeS//vWvHTt2REVFmZiYCDvvKgiYhikUir1797q4uLz66qtEFBgY2NHRkZiYGBUVZWCg7e0FjuOISP2aBfzIoEGDtFBdm4vi7t270dHR+/btW758eVJSEgk97yrYRNQwIyOjkJAQ/k+KN3/+/JaWlvr6eu03Y2VlRUT3799Xjdy/f9/Y2Fg7l8rQ2qLIy8ubOHFicXHx4cOHMzMz+YvtCDvvKgiYht25c6e8vJxTu9IJ//uWSqXab8bGxkYkEl25ckU1UlNT0/2TEiPaWRR5eXnz5s1buHDhxYsXAwMDVePCzrsKAqZhlZWVzs7O6nurjh49Onr0aP4NVcssLS29vLwOHz7M31UoFEePHl24cKF2qmthUSgUivDw8MWLF6ekpHTZhynsvKvgM5iGeXl5TZ8+PSoqqq6uzsnJqaCgICMjIzs7W6h+YmJi5s6dm5iY6O3tnZqa2tTU9N5772mntBYWxenTpxsaGqytrf/xj3+oj4eEhJiYmAg47/+n5e/d9EFra2tkZKSjo6O5ufnrr7+en5+vtdIymazLV70cxx04cGDatGlDhgzx9vauqKjQZnXWi2LXrl09/lU3NjbyE2ht3p8G10UEYAifwQAYQsAAGELAABhCwAAYQsAAGELAABhCwAAYQsAAGELAABhCwAAYQsAAGELAABhCwAAYQsAAGELAABhCwAAYQsAAGELAABhCwAAYQsAAGELAABhCwAAYQsAAGELAABhCwAAYQsAAGELAABhCwAAYQsAAGELAABhCwAAYQsAAGELAABhCwAAYQsAAGELAABhCwAAYQsAAGELAABhCwAAYQsAAGELAABhCwAAYQsAAGELAABhCwAAYQsAAGELAABhCwAAYQsAAGELAABhCwAAYQsAAGELAABhCwAAYQsAAGELAABhCwAAYQsAAGELAABhCwAAYQsAAGPofLpaED32hpmcAAAAASUVORK5CYII=" /><!-- --></p>
</div>
<div id="simulate-an-alignment-based-on-the-twin-tree" class="section level2">
<h2>3.2. Simulate an alignment based on the twin tree</h2>
<p>Now we want to plug in:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a><span class="fu">head</span>(sim_twal_with_std_nsm)</span></code></pre></div>
<pre><code>##                                                                                      
## 1 function (twin_phylogeny, root_sequence, true_alignment = &quot;irrelevant&quot;,            
## 2     mutation_rate = 1, site_model = beautier::create_jc69_site_model())            
## 3 {                                                                                  
## 4     alignment &lt;- pirouette::sim_alignment_with_std_nsm(phylogeny = twin_phylogeny, 
## 5         root_sequence = root_sequence, mutation_rate = mutation_rate,              
## 6         site_model = site_model)</code></pre>
<p>Here comes partial function evaluation to the rescue:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" tabindex="-1"></a>sim_twin_align_fun <span class="ot">&lt;-</span> pryr<span class="sc">::</span><span class="fu">partial</span>(</span>
<span id="cb40-2"><a href="#cb40-2" tabindex="-1"></a>  sim_twal_with_std_nsm,</span>
<span id="cb40-3"><a href="#cb40-3" tabindex="-1"></a>  <span class="at">mutation_rate =</span> <span class="fl">0.1</span></span>
<span id="cb40-4"><a href="#cb40-4" tabindex="-1"></a>)</span>
<span id="cb40-5"><a href="#cb40-5" tabindex="-1"></a><span class="fu">head</span>(sim_twin_align_fun)</span></code></pre></div>
<pre><code>##                                                  
## 1 function (...)                                 
## 2 sim_twal_with_std_nsm(mutation_rate = 0.1, ...)</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" tabindex="-1"></a>pirouette<span class="sc">::</span><span class="fu">check_sim_twal_fun</span>(sim_twin_align_fun)</span></code></pre></div>
<p>Plugging it in:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a>twin_alignment <span class="ot">&lt;-</span> pirouette<span class="sc">::</span><span class="fu">sim_twin_alignment</span>(</span>
<span id="cb43-2"><a href="#cb43-2" tabindex="-1"></a>  <span class="at">twin_phylogeny =</span> twin_phylogeny,</span>
<span id="cb43-3"><a href="#cb43-3" tabindex="-1"></a>  <span class="at">true_alignment =</span> true_alignment,</span>
<span id="cb43-4"><a href="#cb43-4" tabindex="-1"></a>  <span class="at">alignment_params =</span> pirouette<span class="sc">::</span><span class="fu">create_test_alignment_params</span>(),</span>
<span id="cb43-5"><a href="#cb43-5" tabindex="-1"></a>  <span class="at">twinning_params =</span> pirouette<span class="sc">::</span><span class="fu">create_twinning_params</span>(</span>
<span id="cb43-6"><a href="#cb43-6" tabindex="-1"></a>    <span class="at">sim_twal_fun =</span> sim_twin_align_fun</span>
<span id="cb43-7"><a href="#cb43-7" tabindex="-1"></a>  )</span>
<span id="cb43-8"><a href="#cb43-8" tabindex="-1"></a>)</span>
<span id="cb43-9"><a href="#cb43-9" tabindex="-1"></a>ape<span class="sc">::</span><span class="fu">image.DNAbin</span>(twin_alignment, <span class="at">main =</span> <span class="st">&quot;Twin alignment&quot;</span>, <span class="at">legend =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Or use <code>get_sim_twal_with_std_nsm_fun</code> to do the partial
function evaluation for you:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" tabindex="-1"></a>twin_alignment <span class="ot">&lt;-</span> pirouette<span class="sc">::</span><span class="fu">sim_twin_alignment</span>(</span>
<span id="cb44-2"><a href="#cb44-2" tabindex="-1"></a>  <span class="at">twin_phylogeny =</span> twin_phylogeny,</span>
<span id="cb44-3"><a href="#cb44-3" tabindex="-1"></a>  <span class="at">true_alignment =</span> true_alignment,</span>
<span id="cb44-4"><a href="#cb44-4" tabindex="-1"></a>  <span class="at">alignment_params =</span> pirouette<span class="sc">::</span><span class="fu">create_test_alignment_params</span>(),</span>
<span id="cb44-5"><a href="#cb44-5" tabindex="-1"></a>  <span class="at">twinning_params =</span> pirouette<span class="sc">::</span><span class="fu">create_twinning_params</span>(</span>
<span id="cb44-6"><a href="#cb44-6" tabindex="-1"></a>    <span class="at">sim_twal_fun =</span></span>
<span id="cb44-7"><a href="#cb44-7" tabindex="-1"></a>      pirouette<span class="sc">::</span><span class="fu">get_sim_twal_with_std_nsm_fun</span>(</span>
<span id="cb44-8"><a href="#cb44-8" tabindex="-1"></a>        <span class="at">mutation_rate =</span> <span class="fl">0.1</span></span>
<span id="cb44-9"><a href="#cb44-9" tabindex="-1"></a>      )</span>
<span id="cb44-10"><a href="#cb44-10" tabindex="-1"></a>  )</span>
<span id="cb44-11"><a href="#cb44-11" tabindex="-1"></a>)</span>
<span id="cb44-12"><a href="#cb44-12" tabindex="-1"></a>ape<span class="sc">::</span><span class="fu">image.DNAbin</span>(twin_alignment, <span class="at">main =</span> <span class="st">&quot;Twin alignment&quot;</span>, <span class="at">legend =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="simulate-an-alignment-based-on-the-twin-tree-true-alignment-and-root-sequence" class="section level2">
<h2>3.3. Simulate an alignment based on the twin tree, true alignment
and root sequence</h2>
<p>Now we want to plug in:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a><span class="fu">head</span>(sim_twal_with_same_n_mutation)</span></code></pre></div>
<pre><code>##                                                                               
## 1 function (twin_phylogeny, true_alignment, root_sequence, mutation_rate = 1, 
## 2     site_model = beautier::create_jc69_site_model(), max_n_tries = 1000,    
## 3     verbose = FALSE)                                                        
## 4 {                                                                           
## 5     beautier::check_phylogeny(twin_phylogeny)                               
## 6     pirouette::check_alignment(true_alignment)</code></pre>
<p>Here comes partial function evaluation to the rescue:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" tabindex="-1"></a>sim_twin_align_fun <span class="ot">&lt;-</span> pryr<span class="sc">::</span><span class="fu">partial</span>(</span>
<span id="cb47-2"><a href="#cb47-2" tabindex="-1"></a>  sim_twal_with_same_n_mutation,</span>
<span id="cb47-3"><a href="#cb47-3" tabindex="-1"></a>  <span class="at">mutation_rate =</span> <span class="fl">0.5</span></span>
<span id="cb47-4"><a href="#cb47-4" tabindex="-1"></a>)</span>
<span id="cb47-5"><a href="#cb47-5" tabindex="-1"></a><span class="fu">head</span>(sim_twin_align_fun)</span></code></pre></div>
<pre><code>##                                                          
## 1 function (...)                                         
## 2 sim_twal_with_same_n_mutation(mutation_rate = 0.5, ...)</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" tabindex="-1"></a>pirouette<span class="sc">::</span><span class="fu">check_sim_twal_fun</span>(sim_twin_align_fun)</span></code></pre></div>
<p>Plugging it in:</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" tabindex="-1"></a>twin_alignment <span class="ot">&lt;-</span> pirouette<span class="sc">::</span><span class="fu">sim_twin_alignment</span>(</span>
<span id="cb50-2"><a href="#cb50-2" tabindex="-1"></a>  <span class="at">twin_phylogeny =</span> twin_phylogeny,</span>
<span id="cb50-3"><a href="#cb50-3" tabindex="-1"></a>  <span class="at">true_alignment =</span> true_alignment,</span>
<span id="cb50-4"><a href="#cb50-4" tabindex="-1"></a>  <span class="at">alignment_params =</span> pirouette<span class="sc">::</span><span class="fu">create_test_alignment_params</span>(</span>
<span id="cb50-5"><a href="#cb50-5" tabindex="-1"></a>    <span class="at">root_sequence =</span> root_sequence</span>
<span id="cb50-6"><a href="#cb50-6" tabindex="-1"></a>  ),</span>
<span id="cb50-7"><a href="#cb50-7" tabindex="-1"></a>  <span class="at">twinning_params =</span> pirouette<span class="sc">::</span><span class="fu">create_twinning_params</span>(</span>
<span id="cb50-8"><a href="#cb50-8" tabindex="-1"></a>    <span class="at">sim_twal_fun =</span> sim_twin_align_fun</span>
<span id="cb50-9"><a href="#cb50-9" tabindex="-1"></a>  )</span>
<span id="cb50-10"><a href="#cb50-10" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## Warning in pirouette::sim_alignment_with_n_mutations(phylogeny =
## twin_phylogeny, : &#39;sim_alignment_with_n_mutations&#39; tried 1000 times, without
## simulating an alignment with 0 mutations</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" tabindex="-1"></a>ape<span class="sc">::</span><span class="fu">image.DNAbin</span>(twin_alignment, <span class="at">main =</span> <span class="st">&quot;Twin alignment&quot;</span>, <span class="at">legend =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Or use <code>get_sim_twal_with_std_nsm_fun</code> to do the partial
function evaluation for you:</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" tabindex="-1"></a>twin_alignment <span class="ot">&lt;-</span> pirouette<span class="sc">::</span><span class="fu">sim_twin_alignment</span>(</span>
<span id="cb53-2"><a href="#cb53-2" tabindex="-1"></a>  <span class="at">twin_phylogeny =</span> twin_phylogeny,</span>
<span id="cb53-3"><a href="#cb53-3" tabindex="-1"></a>  <span class="at">true_alignment =</span> true_alignment,</span>
<span id="cb53-4"><a href="#cb53-4" tabindex="-1"></a>  <span class="at">alignment_params =</span> pirouette<span class="sc">::</span><span class="fu">create_test_alignment_params</span>(),</span>
<span id="cb53-5"><a href="#cb53-5" tabindex="-1"></a>  <span class="at">twinning_params =</span> pirouette<span class="sc">::</span><span class="fu">create_twinning_params</span>(</span>
<span id="cb53-6"><a href="#cb53-6" tabindex="-1"></a>    <span class="at">sim_twal_fun =</span></span>
<span id="cb53-7"><a href="#cb53-7" tabindex="-1"></a>      pirouette<span class="sc">::</span><span class="fu">get_sim_twal_with_std_nsm_fun</span>(</span>
<span id="cb53-8"><a href="#cb53-8" tabindex="-1"></a>        <span class="at">mutation_rate =</span> <span class="fl">0.1</span></span>
<span id="cb53-9"><a href="#cb53-9" tabindex="-1"></a>      )</span>
<span id="cb53-10"><a href="#cb53-10" tabindex="-1"></a>  )</span>
<span id="cb53-11"><a href="#cb53-11" tabindex="-1"></a>)</span>
<span id="cb53-12"><a href="#cb53-12" tabindex="-1"></a>ape<span class="sc">::</span><span class="fu">image.DNAbin</span>(twin_alignment, <span class="at">main =</span> <span class="st">&quot;Twin alignment&quot;</span>, <span class="at">legend =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
